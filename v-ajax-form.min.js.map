{"version":3,"file":"v-ajax-form.min.js","sources":["src/components/VAjaxForm.vue","src/main.js"],"sourcesContent":["<template>\n    <form v-bind=\"$attrs\" :action=\"action\" :method=\"method\" @submit.prevent=\"submit\">\n        <slot></slot>\n    </form>\n</template>\n<script>\nexport default {\n    name: 'VAjaxForm',\n    inheritAttrs: false,\n    props: {\n        action: {\n            type: String,\n            required: true\n        },\n        method: {\n            type: String,\n            default: 'GET',\n            validator: (value) => ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'].includes(value.toUpperCase())\n        },\n        uriEncode: {\n            type: Boolean,\n            default: false\n        }\n    },\n    emits: ['start', 'receive', 'fail', 'done'],\n    methods: {\n        request: function (params) {\n            const vm = this;\n            vm.$emit('start', params);\n            \n            const method = vm.method.toUpperCase();\n            let url = vm.action;\n            const options = { method: method };\n            \n            if (method === 'GET') {\n                const query = new URLSearchParams(params).toString();\n                if (query) {\n                    url += (url.indexOf('?') >= 0 ? '&' : '?') + query;\n                }\n            } else if (method === 'POST') {\n                options.headers = { 'Content-Type': 'application/x-www-form-urlencoded' };\n                options.body = new URLSearchParams(params);\n            } else {\n                options.headers = { 'Content-Type': 'application/json' };\n                options.body = JSON.stringify(params);\n            }\n            \n            fetch(url, options)\n                .then(function (response) {\n                    if (!response.ok) {\n                        throw new Error('HTTP error! status: ' + response.status);\n                    }\n                    return response.text().then(function(text) {\n                        try {\n                            return JSON.parse(text);\n                        } catch (e) {\n                            return text;\n                        }\n                    }).then(function(data) {\n                        vm.$emit('receive', { \n                            data: data, \n                            status: response.status, \n                            statusText: response.statusText\n                        });\n                    });\n                })\n                .catch(function (error) {\n                    vm.$emit('fail', error);\n                })\n                .finally(function () {\n                    vm.$emit('done', params);\n                });\n                }, submit: function () {\n            let params = {};\n            let vm = this;\n            vm.$el.querySelectorAll('input,select,textarea').forEach(function(el){\n                if ((typeof el.attributes['disabled'] === 'undefined')\n                    && (typeof el.attributes['name'] != 'undefined')\n                ) {\n                    if ((el.type === 'radio' || el.type === 'checkbox') && !el.checked) return;\n                    let val = el.value;\n                    let name = el.attributes['name'].value;\n                    if(vm.uriEncode) {\n                        val = encodeURIComponent(val);\n                        name = encodeURIComponent(name);\n                    }\n                    if (typeof params[name] === 'undefined') {\n                        params[name] = val;\n                    } else if (params[name] instanceof Array) {\n                        params[name].push(val);\n                    } else {\n                        params[name] = [params[name], val];\n                    }\n                }\n            });\n            vm.request(params);\n        }\n    }\n}\n</script>\n","import VAjaxForm from './components/VAjaxForm.vue';\n\nconst VAjaxFormPlugin = {\n  install(app) {\n    app.component('v-ajax-form', VAjaxForm);\n  }\n};\n\n// Auto-install when Vue is found (browser)\nif (typeof window !== 'undefined' && window.Vue) {\n  window.Vue.createApp({}).use(VAjaxFormPlugin);\n}\n\nexport default VAjaxFormPlugin;\n"],"names":["_sfc_main","name","inheritAttrs","props","action","type","String","required","method","default","validator","value","includes","toUpperCase","uriEncode","Boolean","emits","methods","request","params","vm","this","$emit","url","options","query","URLSearchParams","toString","indexOf","headers","body","JSON","stringify","fetch","then","response","ok","Error","status","text","parse","e","data","statusText","catch","error","finally","submit","$el","querySelectorAll","forEach","el","attributes","checked","val","encodeURIComponent","Array","push","_createElementBlock","createElementBlock","_mergeProps","mergeProps","_ctx","$attrs","$props","onSubmit","$options","args","_renderSlot","$slots","VAjaxFormPlugin","install","app","component","VAjaxForm","window","Vue","createApp","use"],"mappings":"uCAMA,MAAKA,EAAU,CACXC,KAAM,YACNC,cAAc,EACdC,MAAO,CACHC,OAAQ,CACJC,KAAMC,OACNC,UAAU,GAEdC,OAAQ,CACJH,KAAMC,OACNG,QAAS,MACTC,UAAYC,GAAU,CAAC,MAAO,OAAQ,MAAO,SAAU,SAASC,SAASD,EAAME,gBAEnFC,UAAW,CACPT,KAAMU,QACNN,SAAS,IAGjBO,MAAO,CAAC,QAAS,UAAW,OAAQ,QACpCC,QAAS,CACLC,QAAS,SAAUC,GACf,MAAMC,EAAKC,KACXD,EAAGE,MAAM,QAASH,GAElB,MAAMX,EAASY,EAAGZ,OAAOK,cACzB,IAAIU,EAAMH,EAAGhB,OACb,MAAMoB,EAAU,CAAEhB,OAAQA,GAE1B,GAAe,QAAXA,EAAkB,CAClB,MAAMiB,EAAQ,IAAIC,gBAAgBP,GAAQQ,WACtCF,IACAF,IAAQA,EAAIK,QAAQ,MAAQ,EAAI,IAAM,KAAOH,OAE/B,SAAXjB,GACPgB,EAAQK,QAAU,CAAE,eAAgB,qCACpCL,EAAQM,KAAO,IAAIJ,gBAAgBP,KAEnCK,EAAQK,QAAU,CAAE,eAAgB,oBACpCL,EAAQM,KAAOC,KAAKC,UAAUb,IAGlCc,MAAMV,EAAKC,GACNU,MAAK,SAAUC,GACZ,IAAKA,EAASC,GACV,MAAM,IAAIC,MAAM,uBAAyBF,EAASG,QAEtD,OAAOH,EAASI,OAAOL,MAAK,SAASK,GACjC,IACI,OAAOR,KAAKS,MAAMD,EACtB,CAAE,MAAOE,GACL,OAAOF,CACX,KACDL,MAAK,SAASQ,GACbtB,EAAGE,MAAM,UAAW,CAChBoB,KAAMA,EACNJ,OAAQH,EAASG,OACjBK,WAAYR,EAASQ,YAE7B,GACH,IACAC,OAAM,SAAUC,GACbzB,EAAGE,MAAM,OAAQuB,EACpB,IACAC,SAAQ,WACL1B,EAAGE,MAAM,OAAQH,EACrB,GACC,EAAE4B,OAAQ,WACf,IAAI5B,EAAS,CAAE,EACXC,EAAKC,KACTD,EAAG4B,IAAIC,iBAAiB,yBAAyBC,SAAQ,SAASC,GAC9D,QAA0C,IAA9BA,EAAGC,WAAqB,eACI,IAAzBD,EAAGC,WAAiB,KACjC,CACE,IAAiB,UAAZD,EAAG9C,MAAgC,aAAZ8C,EAAG9C,QAAyB8C,EAAGE,QAAS,OACpE,IAAIC,EAAMH,EAAGxC,MACTV,EAAOkD,EAAGC,WAAiB,KAAEzC,MAC9BS,EAAGN,YACFwC,EAAMC,mBAAmBD,GACzBrD,EAAOsD,mBAAmBtD,SAEF,IAAjBkB,EAAOlB,GACdkB,EAAOlB,GAAQqD,EACRnC,EAAOlB,aAAiBuD,MAC/BrC,EAAOlB,GAAMwD,KAAKH,GAElBnC,EAAOlB,GAAQ,CAACkB,EAAOlB,GAAOqD,EAEtC,CACJ,IACAlC,EAAGF,QAAQC,EACf,6JA/FJuC,EAEOC,mBAAA,OAFPC,EAEOC,WAFOC,EAAMC,OAAA,CAAG3D,OAAQ4D,EAAM5D,OAAGI,OAAQwD,EAAMxD,OAAGyD,8CAAgBC,EAAMnB,QAAAmB,EAAAnB,UAAAoB,IAAA,CAAA,gBAC3EC,aAAaN,EAAAO,OAAA,sBCAhB,MAACC,EAAkB,CACtB,OAAAC,CAAQC,GACNA,EAAIC,UAAU,cAAeC,EACjC,SAIsB,oBAAXC,QAA0BA,OAAOC,KAC1CD,OAAOC,IAAIC,UAAU,CAAE,GAAEC,IAAIR"}