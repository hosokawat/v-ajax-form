var VAjaxForm=function(e){"use strict";const t=["action","method"],o=Object.assign({name:"VAjaxForm",inheritAttrs:!1},{__name:"VAjaxForm",props:{action:{type:String,required:!0},method:{type:String,default:"GET",validator:e=>["GET","POST","PUT","DELETE","PATCH"].includes(e.toUpperCase())},uriEncode:{type:Boolean,default:!1}},emits:["start","receive","fail","done"],setup(o,{emit:a}){const n=o,r=a,i=e.ref(null),s=e.computed((()=>null!==i.value?.querySelector('input[type="file"]'))),c=async()=>{const e=(()=>{const e=i.value;if(!e)return console.warn("VAjaxForm: Could not access form element"),null;if(s.value){const t=new FormData;return e.querySelectorAll("input,select,textarea").forEach((e=>{if(void 0===e.attributes.disabled&&void 0!==e.attributes.name){const o=e.attributes.name.value;if("file"===e.type)Array.from(e.files||[]).forEach((e=>{t.append(o,e)}));else{if(!("radio"!==e.type&&"checkbox"!==e.type||e.checked))return;{let a=e.value;n.uriEncode&&(a=encodeURIComponent(a)),t.append(n.uriEncode?encodeURIComponent(o):o,a)}}}})),t}{const t={};return e.querySelectorAll("input,select,textarea").forEach((e=>{if(void 0===e.attributes.disabled&&void 0!==e.attributes.name){if(("radio"===e.type||"checkbox"===e.type)&&!e.checked)return;let o=e.value,a=e.attributes.name.value;n.uriEncode&&(o=encodeURIComponent(o),a=encodeURIComponent(a)),void 0===t[a]?t[a]=o:t[a]instanceof Array?t[a].push(o):t[a]=[t[a],o]}})),t}})();null!==e&&await(async e=>{r("start",e);try{const t=n.method.toUpperCase();let o=n.action;const a={method:t};if("GET"===t){if(e instanceof FormData)throw new Error("File uploads are not supported with GET method");const t=new URLSearchParams(e).toString();t&&(o+=(o.indexOf("?")>=0?"&":"?")+t)}else"POST"===t?e instanceof FormData?a.body=e:(a.headers={"Content-Type":"application/x-www-form-urlencoded"},a.body=new URLSearchParams(e)):e instanceof FormData?a.body=e:(a.headers={"Content-Type":"application/json"},a.body=JSON.stringify(e));const i=await fetch(o,a);if(!i.ok)throw new Error("HTTP error! status: "+i.status);const s=await i.text();let c;try{c=JSON.parse(s)}catch(e){c=s}r("receive",{data:c,status:i.status,statusText:i.statusText})}catch(e){r("fail",e)}finally{r("done",e)}})(e)};return(a,n)=>(e.openBlock(),e.createElementBlock("form",e.mergeProps({ref_key:"formRef",ref:i},a.$attrs,{action:o.action,method:o.method,onSubmit:e.withModifiers(c,["prevent"])}),[e.renderSlot(a.$slots,"default")],16,t))}}),a={install(e){e.component("v-ajax-form",o)}};return"undefined"!=typeof window&&window.Vue&&window.Vue.createApp&&(window.VAjaxForm=a),a}(Vue);
//# sourceMappingURL=v-ajax-form.min.js.map
