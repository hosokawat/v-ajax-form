{"version":3,"file":"v-ajax-form.js","sources":["src/components/VAjaxForm.vue","src/main.js"],"sourcesContent":["<template>\n    <form v-bind=\"$attrs\" :action=\"action\" :method=\"method\" @submit.prevent=\"submit\">\n        <slot></slot>\n    </form>\n</template>\n<script>\nexport default {\n    name: 'VAjaxForm',\n    inheritAttrs: false,\n    props: {\n        action: {\n            type: String,\n            required: true\n        },\n        method: {\n            type: String,\n            default: 'GET',\n            validator: (value) => ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'].includes(value.toUpperCase())\n        },\n        uriEncode: {\n            type: Boolean,\n            default: false\n        }\n    },\n    emits: ['start', 'receive', 'fail', 'done'],\n    methods: {\n        request: function (params) {\n            const vm = this;\n            vm.$emit('start', params);\n            \n            const method = vm.method.toUpperCase();\n            let url = vm.action;\n            const options = { method: method };\n            \n            if (method === 'GET') {\n                const query = new URLSearchParams(params).toString();\n                if (query) {\n                    url += (url.indexOf('?') >= 0 ? '&' : '?') + query;\n                }\n            } else if (method === 'POST') {\n                options.headers = { 'Content-Type': 'application/x-www-form-urlencoded' };\n                options.body = new URLSearchParams(params);\n            } else {\n                options.headers = { 'Content-Type': 'application/json' };\n                options.body = JSON.stringify(params);\n            }\n            \n            fetch(url, options)\n                .then(function (response) {\n                    if (!response.ok) {\n                        throw new Error('HTTP error! status: ' + response.status);\n                    }\n                    return response.text().then(function(text) {\n                        try {\n                            return JSON.parse(text);\n                        } catch (e) {\n                            return text;\n                        }\n                    }).then(function(data) {\n                        vm.$emit('receive', { \n                            data: data, \n                            status: response.status, \n                            statusText: response.statusText\n                        });\n                    });\n                })\n                .catch(function (error) {\n                    vm.$emit('fail', error);\n                })\n                .finally(function () {\n                    vm.$emit('done', params);\n                });\n                }, submit: function () {\n            let params = {};\n            let vm = this;\n            vm.$el.querySelectorAll('input,select,textarea').forEach(function(el){\n                if ((typeof el.attributes['disabled'] === 'undefined')\n                    && (typeof el.attributes['name'] != 'undefined')\n                ) {\n                    if ((el.type === 'radio' || el.type === 'checkbox') && !el.checked) return;\n                    let val = el.value;\n                    let name = el.attributes['name'].value;\n                    if(vm.uriEncode) {\n                        val = encodeURIComponent(val);\n                        name = encodeURIComponent(name);\n                    }\n                    if (typeof params[name] === 'undefined') {\n                        params[name] = val;\n                    } else if (params[name] instanceof Array) {\n                        params[name].push(val);\n                    } else {\n                        params[name] = [params[name], val];\n                    }\n                }\n            });\n            vm.request(params);\n        }\n    }\n}\n</script>\n","import VAjaxForm from './components/VAjaxForm.vue';\n\nconst VAjaxFormPlugin = {\n  install(app) {\n    app.component('v-ajax-form', VAjaxForm);\n  }\n};\n\n// Auto-install when Vue is found (browser)\nif (typeof window !== 'undefined' && window.Vue && window.Vue.createApp) {\n  // Vue 3のグローバル変数として利用可能にする\n  window.VAjaxForm = VAjaxFormPlugin;\n}\n\nexport default VAjaxFormPlugin;\n"],"names":["_createElementBlock","_mergeProps","_renderSlot"],"mappings":"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"}